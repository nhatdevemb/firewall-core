<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Tr√¨nh qu·∫£n l√Ω BMC IDS/IPS</title>
  <!-- plugins:css -->
  <link rel="stylesheet" href="../../assets/vendors/mdi/css/materialdesignicons.min.css">
  <link rel="stylesheet" href="../../assets/vendors/css/vendor.bundle.base.css">

  <link rel="shortcut icon" href="../../assets/images/iconnho.png" />
  <title>Test DataTables v·ªõi API</title>
  <!-- Th√™m CSS c·ªßa DataTables -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
  <!-- Th√™m jQuery t·ª´ CDN -->
  <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
  <!-- Th√™m DataTables JS t·ª´ CDN -->
  <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
  <!-- Th√™m Bootstrap CSS (cho modal) -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/hienthibang.css">
  <link rel="stylesheet" href="../../assets/css/bang.css">
</head>

<body>
  <div class="container-scroller">
    <!-- partial:../../partials/_sidebar.html -->
    <nav class="sidebar sidebar-offcanvas" id="sidebar">
      <div class="sidebar-brand-wrapper d-none d-lg-flex align-items-center justify-content-center fixed-top">
        <a class="sidebar-brand brand-logo" href="../../index.html"><img src="../../assets/images/IDDS.png"
            alt="logo" /></a>
        <a class="sidebar-brand brand-logo-mini" href="../../index.html"><img src="../../assets/images/logo-mini.svg"
            alt="logo" /></a>
      </div>
      <ul class="nav">
        <li class="nav-item profile">
        </li>
        <li class="nav-item nav-category">
          <span class="nav-link">Navigation</span>
        </li>
        <li class="nav-item menu-items">
          <a class="nav-link" href="../../index.html">
            <span class="menu-icon">
              <i class="mdi mdi-speedometer"></i>
            </span>
            <span class="menu-title">Trang ch·ªß</span>
          </a>
        </li>
        <li class="nav-item menu-items">
          <a class="nav-link" data-toggle="collapse" href="#ui-basic" aria-expanded="false" aria-controls="ui-basic">
            <span class="menu-icon">
              <i class="mdi mdi-laptop"></i>
            </span>
            <span class="menu-title">Rule Database</span>
            <i class="menu-arrow"></i>
          </a>
          <div class="collapse" id="ui-basic">
            <ul class="nav flex-column sub-menu">
              <li class="nav-item"> <a class="nav-link" href="checkDatabase.html">Ki·ªÉm tra Database</a></li>
              <li class="nav-item"> <a class="nav-link" href="suarule.html">T√¨m v√† s·ª≠a Rules</a></li>
              <li class="nav-item"> <a class="nav-link" href="capnhatrule.html">C·∫≠p nh·∫≠t Rules</a></li>
          </div>
        </li>
        <li class="nav-item menu-items">
          <a class="nav-link" href="switchmode.html">
            <span class="menu-icon">
              <i class="mdi mdi-playlist-play"></i>
            </span>
            <span class="menu-title">Chuy·ªÉn ch·∫ø ƒë·ªô IDS/IPS</span>
          </a>
        </li>
        <!-- <li class="nav-item menu-items">
            <a class="nav-link" href="../../pages/forms/basic_elements.html">
              <span class="menu-icon">
                <i class="mdi mdi-playlist-play"></i>
              </span>
              <span class="menu-title">Form Elements</span>
            </a>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link" href="../../pages/tables/basic-table.html">
              <span class="menu-icon">
                <i class="mdi mdi-table-large"></i>
              </span>
              <span class="menu-title">Tables</span>
            </a>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link" href="../../pages/charts/chartjs.html">
              <span class="menu-icon">
                <i class="mdi mdi-chart-bar"></i>
              </span>
              <span class="menu-title">Charts</span>
            </a>
          </li>
          <li class="nav-item menu-items">
            <a class="nav-link" href="../../pages/icons/mdi.html">
              <span class="menu-icon">
                <i class="mdi mdi-contacts"></i>
              </span>
              <span class="menu-title">Icons</span>
            </a>
          </li> -->
          
        <li class="nav-item menu-items">
          <a class="nav-link" data-toggle="collapse" href="#auth" aria-expanded="false" aria-controls="auth">
            <span class="menu-icon">
              <i class="mdi mdi-security"></i>
            </span>
            <span class="menu-title">S·ª≠a c·∫•u h√¨nh</span>
            <i class="menu-arrow"></i>
          </a>
          <div class="collapse" id="auth">
            <ul class="nav flex-column sub-menu">
              <!-- <li class="nav-item"> <a class="nav-link" href="../../pages/samples/blank-page.html"> Blank Page </a></li>
                <li class="nav-item"> <a class="nav-link" href="../../pages/samples/error-404.html"> 404 </a></li>
                <li class="nav-item"> <a class="nav-link" href="../../pages/samples/error-500.html"> 500 </a></li> -->
              <li class="nav-item"> <a class="nav-link" href="/pages/ui-features/setting.html"> Config </a></li>
              <!-- <li class="nav-item"> <a class="nav-link" href="../../pages/samples/register.html"> Register </a></li> -->
            </ul>
          </div>
        </li>
        <!-- <li class="nav-item menu-items">
            <a class="nav-link" href="http://www.bootstrapdash.com/demo/corona-free/jquery/documentation/documentation.html">
              <span class="menu-icon">
                <i class="mdi mdi-file-document-box"></i>
              </span>
              <span class="menu-title">Documentation</span>
            </a>
          </li> -->
          <li class="nav-item menu-items">
            <a class="nav-link" href="javascript:void(0);" onclick="toggleFirewallPopup()">
                <span class="menu-icon">
                    <i class="mdi mdi-lock"></i> <!-- Thay icon ph√π h·ª£p -->
                </span>
                <span class="firewall-menu-item"> 
                    Y√™u c·∫ßu truy c·∫≠p m·ªõi 
                    <span id="firewall-badge" class="firewall-badge">0</span>
                </span>
            </a>
        </li>

        <!-- Popup hi·ªÉn th·ªã request -->
        <div id="firewall-popup-container" class="firewall-popup-overlay">
            <div class="firewall-popup-content">
                <!-- Header v·ªõi n√∫t ƒë√≥ng g√≥c ph·∫£i -->
                <div class="firewall-popup-header">
                    <span>New Firewall Requests</span>
                </div>

                <!-- B·∫£ng hi·ªÉn th·ªã request -->
                <table>
                    <thead>
                        <tr>
                            <th>MAC Address</th>
                            <th>Status</th>
                            <th>Timestamp</th>
                            <th>Name</th> <!-- Th√™m c·ªôt "Name" -->
                        </tr>
                    </thead>
                    <tbody id="firewall-popup-table">
                        <!-- D·ªØ li·ªáu ƒë·ªông s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
                    </tbody>
                </table>

                <!-- Footer v·ªõi 2 n√∫t -->
                <div class="firewall-popup-footer">
                    <button class="firewall-log-btn">View Full Log</button>
                    <button class="firewall-footer-close-btn" onclick="closeFirewallPopup()">Close</button>
                </div>
            </div>
        </div>

        <!-- üî• Popup View Full Log -->
        <div id="firewall-full-log-container" class="firewall-popup-overlay">
            <div class="firewall-popup-content">
                <!-- Header -->
                <div class="firewall-popup-header">
                    <span>Firewall Full Log</span>
                </div>

                <!-- B·∫£ng hi·ªÉn th·ªã log ƒë·∫ßy ƒë·ªß -->
                <table>
                    <thead>
                        <tr>
                            <th>MAC Address</th>
                            <th>Status</th>
                            <th>Timestamp</th>
                            <th>Name</th> <!-- Th√™m c·ªôt "Name" -->
                        </tr>
                    </thead>
                    <tbody id="firewall-full-log-table">
                        <!-- üî• D·ªØ li·ªáu t·ª´ file log s·∫Ω ƒë∆∞·ª£c load v√†o ƒë√¢y -->
                    </tbody>
                </table>

                <!-- N√∫t ƒë√≥ng -->
                <div class="firewall-popup-footer">
                    <button class="firewall-footer-close-btn" onclick="closeFullLogPopup()">Close</button>
                </div>
            </div>
        </div>

        <script src="../../assets/js/firewall.js"></script>



        <li class="nav-item menu-items">
          <a class="nav-link" href="../tables/basic-table.html">
            <span class="menu-icon">
              <i class="mdi mdi-table-large"></i>
            </span>
            <span class="menu-title">C√°ch ly & Kh√¥i ph·ª•c</span>
          </a>
        </li>

        <li class="nav-item menu-items">
          <a class="nav-link" href="../firewall/firewall.html">
            <span class="menu-icon">
              <i class="mdi mdi-contacts"></i>
            </span>
            <span class="menu-title">T∆∞·ªùng l·ª≠a</span>
          </a>
        </li>


        <li class="nav-item menu-items">
          <a class="nav-link" href="../pages/clamav/clamav.html">
            <span class="menu-icon">
              <i class="mdi mdi-playlist-play"></i>
            </span>
            <span class="menu-title">Qu·∫£n l√Ω ch·ªëng virus</span>
          </a>
        </li>


        <li class="nav-item menu-items">
          <a class="nav-link" href="../../login">
            <span class="menu-icon">
              <i class="mdi mdi-logout"></i>
            </span>
            <span class="menu-title">ƒêƒÉng xu·∫•t</span>
          </a>
        </li>
      </ul>
    </nav>

    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
      <!-- partial:../../partials/_navbar.html -->
      <nav class="navbar p-0 fixed-top d-flex flex-row">
        <div class="navbar-brand-wrapper d-flex d-lg-none align-items-center justify-content-center">
          <a class="navbar-brand brand-logo-mini" href="../../index.html"><img src="../../assets/images/logo-mini.svg"
              alt="logo" /></a>
        </div>
        <div class="navbar-menu-wrapper flex-grow d-flex align-items-stretch">
          <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button"
            data-toggle="offcanvas">
            <span class="mdi mdi-format-line-spacing"></span>
          </button>
        </div>
      </nav>
      <!-- partial -->
      <div class="main-panel">
        <div class="content-wrapper">



          <div class="row">

            <div class="col-xl-3 col-sm-6 grid-margin stretch-card">
              <div class="card custom-height-card" id="activeRuleCategories">
                <div class="card-body">
                  <div class="row">
                    <div class="col-9">
                      <div class="d-flex align-items-center align-self-start">
                        <h3 class="mb-0" id="rulesCount"></h3>
                      </div>
                    </div>
                    <div class="col-3" style="opacity: 0;">
                      <div class="icon icon-box-success">
                        <span class="mdi mdi-arrow-top-right icon-item"></span>
                      </div>
                    </div>
                  </div>
                  <h6 class="text-muted font-weight-normal">Active rule categories</h6>
                </div>
              </div>
            </div>

            <!-- Popup hi·ªÉn th·ªã danh s√°ch rules -->
            <!-- Popup container -->
            <div class="rule-popup-container" style="display: none;">
              <div id="ruleListPopup" class="rule-popup">
                <button class="rule-popup-close"></button>
                <h3>Danh s√°ch c√°c nh√≥m Rules</h3>
                <div id="ruleList">
                  <!-- Danh s√°ch rules s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
                </div>
              </div>
            </div>

            <div class="rule-popup-container" style="display: none;">
              <div id="ruleListPopup" class="rule-popup">
                <button class="rule-popup-close">
                  <i class="fas fa-times"></i> <!-- Icon ƒë√≥ng -->
                </button>
                <h3>Rule List</h3>
                <div id="ruleList">
                  <!-- Danh s√°ch rules s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
                </div>
              </div>
            </div>

            <div class="col-xl-3 col-sm-6 grid-margin stretch-card">
              <div class="card custom-height-card" id="bogocCard">
                <div class="card-body">
                  <div class="row">
                    <div class="col-9">
                      <div class="d-flex align-items-center align-self-start">
                        <h3 class="mb-0" id="rulesCountALL"></h3>
                        <p class="text-success ml-2 mb-0 font-weight-medium" style="opacity: 0;">+11%</p>
                      </div>
                    </div>
                    <div class="col-3" style="opacity: 0;">
                      <div class="icon icon-box-success">
                        <span class="mdi mdi-arrow-top-right icon-item"></span>
                      </div>
                    </div>
                  </div>
                  <h6 class="text-muted font-weight-normal">T·ªïng s·ªë rules</h6>
                </div>
              </div>
            </div>

            <div class="col-xl-3 col-sm-6 grid-margin stretch-card">
              <div class="card custom-height-card" id="bogocCard">
                <div class="card-body">
                  <div class="row">
                    <div class="col-9">
                      <div class="d-flex align-items-center align-self-start">
                        <h3 class="mb-0" id="hanlicense"></h3>
                        <p class="text-danger ml-2 mb-0 font-weight-medium" style="opacity: 0;">-2.4%</p>
                      </div>
                    </div>
                    <div class="col-3" style="opacity: 0;">
                      <div class="icon icon-box-danger">
                        <span class="mdi mdi-arrow-bottom-left icon-item"></span>
                      </div>
                    </div>
                  </div>
                  <h6 class="text-muted font-weight-normal">Th·ªùi h·∫°n license</h6>
                </div>
              </div>
            </div>


            <div class="col-xl-3 col-sm-6 grid-margin stretch-card">
              <div class="card custom-height-card" id="checkForUpdateCard"
                onclick="window.location.href='capnhatrule.html'"> <!-- ƒêi·ªÅu h∆∞·ªõng tr·ª±c ti·∫øp -->
                <div class="card-body"
                  style="display: flex; align-items: center; justify-content: center; flex-direction: column; margin: 20px 0;">
                  <h6 class="text-muted font-weight-normal">Check for update</h6>
                </div>
              </div>




            </div>


          </div>


          <div id="popup" class="popup hidden">
            <div class="popup-content">
              <h2 id="popup-title"></h2>
              <p id="popup-message"></p>
              <button onclick="closePopup()">ƒê√≥ng</button>
            </div>
          </div>

          <div class="row">
            <div class="search-container">
              <!-- Ph·∫ßn nh·∫≠p t·ª´ kh√≥a v√† t√¨m ki·∫øm -->
              <div class="column col-md-8">
                <div class="search-box ">
                  <input type="text" id="keyword" placeholder="Nh·∫≠p t·ª´ kh√≥a t√¨m ki·∫øm nh√≥m Rule " autocomplete="off">
                  <button id="searchBtn">T√¨m ki·∫øm</button>
                </div>
              
              <!-- H·ªôp ƒë·ªÉ hi·ªÉn th·ªã c√°c ƒë·ªÅ xu·∫•t file -->
              <div id="suggestion-box"></div>
              <div id="searchResult"></div>
              </div>
              
              <!-- N√∫t S·ª≠a t·ªáp rules -->
              <div class="col-md-4">
                <button id="editRulesBtn" onclick="redirectToEditRules()">S·ª≠a t·ªáp rules n√†y</button>
              </div>
            </div>
          </div>

          <script>
            // H√†m l·∫•y gi√° tr·ªã t·ª´ √¥ t√¨m ki·∫øm v√† chuy·ªÉn h∆∞·ªõng
            function redirectToEditRules() {
              const keyword = document.getElementById('keyword').value.trim(); // L·∫•y gi√° tr·ªã t·ª´ √¥ input
              if (keyword) {
                // Chuy·ªÉn h∆∞·ªõng v√† truy·ªÅn gi√° tr·ªã t√¨m ki·∫øm qua URL
                window.location.href = `fixrulefile.html?search=${encodeURIComponent(keyword)}`;
              } else {
                alert('Vui l√≤ng nh·∫≠p t·ª´ kh√≥a t√¨m ki·∫øm!'); // Th√¥ng b√°o n·∫øu √¥ t√¨m ki·∫øm tr·ªëng
              }
            }
          </script>


          <div>
          </div>

          <!-- <iframe id="contentFrame" style="width: 100%; height: 67.5vh; border: none; border-radius: 16px; overflow: hidden;"></iframe> -->

          <div id="error-message" style="color: red; display: none;">Nh√≥m Rules kh√¥ng t·ªìn t·∫°i</div>
          </nav>
          <!-- </div> -->

          <!-- main-panel ends -->
        </div>
        <div id="rule-section" style="display: none;"> <!-- B·∫£ng b·ªã ·∫©n m·∫∑c ƒë·ªãnh -->
          <table id="hienthirule" class="display" style="width:100%">
            <thead>
              <tr>
                <th>SID</th>
                <th>Message</th>
                <th>Action</th>
                <th>Protocol</th>
                <th>Source</th>
                <th>Destination</th>
                <th>Severity</th>
              </tr>
            </thead>
          </table>

          <!-- Modal ƒë·ªÉ hi·ªÉn th·ªã chi ti·∫øt rule -->
          <div class="modal fade" id="ruleDetailsModal" tabindex="-1" role="dialog"
            aria-labelledby="ruleDetailsModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl modal-dialog-centered" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h2 class="modal-title text-center w-100" id="ruleDetailsModalLabel" style="font-weight:bold;">Chi
                    ti·∫øt Rule</h2>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
                  <button id="editRuleButton" class="btn btn-primary edit-rule-button">S·ª≠a rules n√†y</button>
                </div>
                <div class="modal-body" id="ruleDetailsContent">
                  <p><strong>SID:</strong> <span id="ruleSid"></span></p>
                  <p><strong>Message:</strong> <span id="ruleMsg"></span></p>
                  <p><strong>Action:</strong> <span id="ruleAction"></span></p>
                  <p><strong>Protocol:</strong> <span id="ruleProtocol"></span></p>
                  <p><strong>Source:</strong> <span id="ruleSrc"></span></p>
                  <p><strong>Destination:</strong> <span id="ruleDst"></span></p>
                  <p><strong>Severity:</strong> <span id="ruleSeverity"></span></p>
                  <hr>
                  <h3 class="text-center" style="font-weight:bold;">Rule ƒë·∫ßy ƒë·ªß</h3>
                  <div class="rule-container">
                    <pre id="fullRuleContent" class="border rounded p-3"></pre>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">ƒê√≥ng</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Modal chi ti·∫øt s·ª± kh√°c bi·ªát -->
        <div id="updateDetailsModal" style="display:none;">
          <div id="modalBody">
            <!-- N·ªôi dung chi ti·∫øt s·ª± kh√°c bi·ªát s·∫Ω ƒë∆∞·ª£c ch√®n v√†o ƒë√¢y -->
          </div>
          <button onclick="document.getElementById('updateDetailsModal').style.display='none'">ƒê√≥ng</button>
        </div>


        <!-- Th√™m Bootstrap JS (cho modal) -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
        <script src="src/index.js"></script> <!-- ƒê∆∞·ªùng d·∫´n ƒë·∫øn file index.js c·ªßa b·∫°n -->
        <script src="../../assets/js/suarulenay.js"></script>

        <!-- page-body-wrapper ends -->
      </div>

      <!-- container-scroller -->
      <!-- plugins:js -->

      <!-- endinject -->
      <!-- Plugin js for this page -->
      <!-- End plugin js for this page -->
      <!-- inject:js -->
      <script src="../../assets/js/off-canvas.js"></script>
      <script src="../../assets/js/hoverable-collapse.js"></script>
      <script src="../../assets/js/misc.js"></script>
      <script src="../../assets/js/settings.js"></script>
      <script src="../../assets/js/todolist.js"></script>
      <script src="../../assets/js/rulesCount.js"></script>
      <script src="../../assets/js/countALLrule.js"></script>
      <script src="../../assets/js/last-update.js"></script>
      <script src="../../assets/js/timkiemrule.js"></script>
      <script src="../../assets/js/lietkerule.js"></script>
      <script src="../../assets/js/search.js"></script>
      <script src="../../assets/js/hanlicense.js"></script>


      <!-- container-scroller -->
      <!-- plugins:js -->

      <!-- endinject -->


      <!-- endinject -->
      <!-- Custom js for this page -->
      <script src="assets/js/dashboard.js"></script>
      <!-- End custom js for this page -->
</body>

</html>